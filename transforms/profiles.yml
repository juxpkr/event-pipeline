# í”„ë¡œì íŠ¸ëª… (dbt_project.ymlê³¼ ì¼ì¹˜ì‹œì¼œì•¼í•¨)
analytics_dbt:
  # ë¡œì»¬ì—ì„œ dbt ëª…ë ¹ì„ ì‹¤í–‰í•  ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•  íƒ€ê²Ÿì„ 'dev'ë¡œ ì„¤ì •
  target: dev
  outputs:

    # =================================================================
    # ìš´ì˜ í™˜ê²½ (Airflow ìë™í™” íŒŒì´í”„ë¼ì¸ì´ ì‚¬ìš©)
    # =================================================================
    prod:
      # Spark ì—”ì§„ ì‚¬ìš©
      type: spark
      method: thrift
      host: spark-thrift-server    # Docker ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë¦„
      port: 10001                 # ìš´ì˜ìš© Thrift ì„œë²„ í¬íŠ¸
      user: root
      auth: NOSASL
      schema: gold_prod         # ìš´ì˜ìš© Gold ë°ì´í„°ê°€ ì €ì¥ë  ìµœì¢… ìŠ¤í‚¤ë§ˆ
      http_path: cliservice
      # ì—°ê²° ì•ˆì •ì„±ì„ ìœ„í•œ ì˜µì…˜
      connect_retries: 5
      connect_timeout: 60
      retry_all: true

    # =================================================================
    #  ğŸ’» ê°œë°œ í™˜ê²½ (íŒ€ì›ë“¤ì´ ê°ìì˜ ë¡œì»¬ PCì—ì„œ ì‚¬ìš©)
    # =================================================================
    dev:
      type: spark
      method: thrift
      host: "4.230.26.44"        # VMì˜ ì‹¤ì œ IP ì£¼ì†Œ
      port: 10002                 # ê°œë°œìš© Thrift ì„œë²„ í¬íŠ¸
      user: root
      auth: NOSASL
      # ê°œì¸ë³„ë¡œ ë¶„ë¦¬ëœ ê°œë°œ ìŠ¤í‚¤ë§ˆ (ì˜ˆ: gold_dev_captain)
      # DBT_USER í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ë©´ gold_dev_{DBT_USER} ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©
      schema: "gold_dev"
      http_path: cliservice
      connect_retries: 5
      connect_timeout: 60
      retry_all: true

    # =================================================================
    # PostgreSQL ì„¤ì • (dbt seed ë“± ë‹¤ë¥¸ ìš©ë„ë¡œ ì‚¬ìš©)
    # =================================================================
    postgres:
      type: postgres
      host: "{{ env_var('POSTGRES_HOST', 'postgres') }}"
      user: "{{ env_var('POSTGRES_USER', 'airflow') }}"
      password: "{{ env_var('POSTGRES_PASSWORD', 'airflow') }}"
      port: "{{ env_var('POSTGRES_PORT', '5432') | int }}"
      dbname: "{{ env_var('POSTGRES_DB', 'airflow') }}"
      schema: gold # dbtê°€ ëª¨ë¸ì„ ìƒì„±í•  ê¸°ë³¸ ìŠ¤í‚¤ë§ˆ
      threads: 4
      keepalives_idle: 0